(()=>{var e={};e.id=139,e.ids=[139],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},93075:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>g,serverHooks:()=>f,workAsyncStorage:()=>$,workUnitAsyncStorage:()=>w});var a={};r.r(a),r.d(a,{GET:()=>m,dynamic:()=>c,revalidate:()=>p});var s=r(88797),o=r(10042),i=r(58492),n=r(65645),u=r(11185),d=r.n(u);let c="force-static",p=60;async function l(){if(!d().connection.readyState){if(!process.env.MONGO_URL)throw Error("MONGO_URL is not defined in the environment variables.");await d().connect(process.env.MONGO_URL,{useNewUrlParser:!0,useUnifiedTopology:!0})}}async function m(e){try{let t;await l();let r=new URL(e.url),a=r.searchParams.get("groupBy")||"timeframe",s=r.searchParams.get("timeframe")||"daily";if("products"===a)t=await n.Z.aggregate([{$unwind:"$products"},{$group:{_id:"$products.name",totalSales:{$sum:"$products.price"}}},{$sort:{totalSales:-1}}]);else switch(s){case"daily":t=await n.Z.aggregate([{$group:{_id:{$dateToString:{format:"%Y-%m-%d",date:"$createdAt"}},totalSales:{$sum:"$subtotal"}}},{$sort:{_id:1}}]);break;case"weekly":t=await n.Z.aggregate([{$group:{_id:{$isoWeek:"$createdAt"},totalSales:{$sum:"$subtotal"}}},{$sort:{_id:1}}]);break;case"monthly":t=await n.Z.aggregate([{$group:{_id:{$dateToString:{format:"%Y-%m",date:"$createdAt"}},totalSales:{$sum:"$subtotal"}}},{$sort:{_id:1}}]);break;default:throw Error("Invalid timeframe parameter.")}let o=t.reduce((e,{_id:t,totalSales:r})=>(e[t]=r,e),{});return new Response(JSON.stringify(o),{status:200})}catch(e){return console.error("Error retrieving sales data:",e),new Response(JSON.stringify({error:e.message}),{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/sales/route",pathname:"/api/sales",filename:"route",bundlePath:"app/api/sales/route"},resolvedPagePath:"C:\\xampp\\htdocs\\codebrew2o\\codebrew2\\src\\app\\api\\sales\\route.js",nextConfigOutput:"",userland:a}),{workAsyncStorage:$,workUnitAsyncStorage:w,serverHooks:f}=g;function v(){return(0,i.patchFetch)({workAsyncStorage:$,workUnitAsyncStorage:w})}},78031:()=>{},35303:()=>{},65645:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var a=r(11185),s=r.n(a),o=r(33938),i=r.n(o);let n=new(s()).Schema({customer:{staffname:String},product:[{name:String,price:Number}],total:Number,cartProducts:[{name:String,price:Number,quantity:Number,change:Number}],subtotal:Number,createdAt:{type:Date,default:()=>i().tz("Asia/Manila").toDate()}}),u=s().models.Receipt||s().model("Receipt",n)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[492,785],()=>r(93075));module.exports=a})();