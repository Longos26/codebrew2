(()=>{var e={};e.id=565,e.ids=[565],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},47172:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>c});var r=s(49442),a=s(10042),n=s(48190),i=s.n(n),o=s(63289),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=["",{children:["cart",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,72181)),"C:\\xampp\\htdocs\\codebrew2o\\codebrew2\\src\\app\\cart\\page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,50934)),"C:\\xampp\\htdocs\\codebrew2o\\codebrew2\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["C:\\xampp\\htdocs\\codebrew2o\\codebrew2\\src\\app\\cart\\page.js"],p={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/cart/page",pathname:"/cart",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},72019:(e,t,s)=>{Promise.resolve().then(s.bind(s,72181))},96190:(e,t,s)=>{Promise.resolve().then(s.bind(s,38934))},38934:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(20149),a=s(94035),n=s(18996),i=s(46304),o=s(41111),l=s(50526),c=s(63606),d=s(99548),p=s(4619),u=s(14971);let m=({customer:e={},cartProducts:t=[],subtotal:s=0,createdAt:n})=>{let{staffname:i}=e;return(0,r.jsxs)("div",{id:"receipt",className:"p-6 bg-white shadow-lg rounded-lg",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(u.default,{src:"/tealerinlogo.png",alt:"Company Logo",width:150,height:50,className:"mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"TeaLerin"}),(0,r.jsx)("p",{children:"Contact: 0927-368-5006 | Block 10 Lot 23 Long Road"})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-700",children:"Staff Information"}),(0,r.jsxs)("p",{children:["Name: ",(0,r.jsx)("span",{className:"font-medium",children:i||"No Name"})]}),(0,r.jsxs)("p",{children:["Date: ",(0,r.jsx)("span",{className:"font-medium",children:n?new Date(n).toLocaleString():"N/A"})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h2",{className:"text-center font-bold",children:"Receipt"}),(0,r.jsx)("div",{className:"mt-4",children:t.length>0?t.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("span",{children:[e.name," (x",e.quantity,")"]}),(0,r.jsxs)("span",{children:["₱",(0,a.B)(e).toFixed(2)]})]},t)):(0,r.jsx)("p",{children:"No products in the cart"})}),(0,r.jsx)("div",{className:"mt-4 text-right",children:(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Total:"})," ₱",s.toFixed(2)]})})]}),(0,r.jsxs)("div",{className:"mt-4 border-t pt-4 text-center text-gray-600",children:[(0,r.jsx)("p",{children:"Thank you for your purchase!"}),(0,r.jsx)("p",{children:"Visit us again!"}),(0,r.jsxs)("p",{children:["Please note that this is a non-refundable amount. For any assistance, please email",(0,r.jsx)("b",{children:" paolonavarrosa@gmail.com"}),"."]})]})]})};var x=s(47111);function h(){let{cartProducts:e,removeCartProduct:t,setCartProducts:s,clearCart:u}=(0,c.useContext)(a.A),[h,g]=(0,c.useState)({}),{data:b}=(0,l.U)(),[j,f]=(0,c.useState)(!1),[y,v]=(0,c.useState)(""),[w,N]=(0,c.useState)(null),C=(0,p.useRouter)(),{status:P}=(0,x.useSession)(),k=0;if(e)for(let t of e)k+=(0,a.B)(t);async function S(t){t.preventDefault();let s=new Promise((t,s)=>{fetch("/api/receipt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer:h,cartProducts:e,subtotal:k,change:w})}).then(async r=>{if(r.ok){let s=await r.json();await Promise.all(e.map(async e=>{let t=e.stock-e.quantity;await fetch("/api/menu-items",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:e._id,stock:t})})})),u(),t(s),d.ZP.success("Receipt saved and stock updated!")}else s(Error("Saving receipt failed"))}).catch(e=>{s(e)})});await d.ZP.promise(s,{loading:"Saving your receipt...",success:"Receipt saved and stock updated!",error:e=>e.message||"Something went wrong... Please try again later"})}function _(t,r){if(r<1)return;let a=e[t].stock;if(r>a){(0,d.ZP)(`You can only purchase up to ${a} of this product.`,{icon:"⚠️",style:{background:"#fff",color:"#000"}});return}s(e=>{let s=[...e];return s[t].quantity=r,s})}return"unauthenticated"===P?(C.push("/login"),null):e&&0!==e.length?(0,r.jsxs)("section",{className:"mt-8 px-4",children:[(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(i.Z,{mainHeader:"Your Cart"})}),e&&0!==e.length?(0,r.jsxs)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{children:[e.map((e,s)=>(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between border-b pb-4",children:[(0,r.jsx)(o.Z,{product:e,index:s,onRemove:t}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{className:"bg-gray-200 px-2 py-1 rounded-full hover:bg-gray-300",onClick:()=>_(s,e.quantity-1),children:"-"}),(0,r.jsx)("span",{className:"text-lg font-semibold",children:e.quantity}),(0,r.jsx)("button",{className:"bg-gray-200 px-2 py-1 rounded-full hover:bg-gray-300",onClick:()=>_(s,e.quantity+1),children:"+"})]})]},s)),(0,r.jsxs)("div",{className:"mt-6 flex justify-between items-center text-lg font-semibold",children:[(0,r.jsx)("span",{children:"Subtotal:"}),(0,r.jsxs)("span",{children:["₱",k.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"bg-gray-100 p-6 rounded-lg shadow-md space-y-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Checkout"}),(0,r.jsxs)("form",{onSubmit:S,children:[(0,r.jsx)(n.Z,{customerProps:h,setCustomerProp:function(e,t){g(s=>({...s,[e]:t}))}}),(0,r.jsx)("input",{type:"number",value:y,onChange:e=>{let t=e.target.value;if(v(t),t&&!isNaN(t)){let e=parseFloat(t)-k;N(e>=0?e:0)}else N(null)},placeholder:"Enter amount (e.g., 20 pesos)",className:"w-full p-2 border border-gray-300 rounded-md"}),null!==w&&(0,r.jsxs)("div",{className:"mt-2 text-lg font-semibold",children:[(0,r.jsx)("span",{children:"Change: "}),(0,r.jsxs)("span",{children:["₱",w.toFixed(2)]})]}),(0,r.jsx)("button",{type:"submit",className:"w-full mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Save Receipt"})]}),(0,r.jsx)("button",{onClick:()=>f(!0),className:"w-full px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Print Receipt"})]})]}):(0,r.jsxs)("section",{className:"mt-8 text-center space-y-4",children:[(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"Your cart is currently empty \uD83D\uDE14"}),(0,r.jsx)("button",{onClick:()=>C.push("/menu"),className:"px-6 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Browse Menu"})]}),j&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-lg w-full",children:[(0,r.jsx)(m,{customer:h,cartProducts:e,subtotal:k,createdAt:new Date().toLocaleString()}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,r.jsx)("button",{onClick:()=>{window.print(),f(!1)},className:"px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600",children:"Print"}),(0,r.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600",children:"Close"})]})]})})]}):(0,r.jsxs)("section",{className:"mt-8 text-center",children:[(0,r.jsx)(i.Z,{mainHeader:"Cart"}),(0,r.jsx)("p",{className:"mt-4",children:"Cart is empty \uD83D\uDE14"})]})}},50526:(e,t,s)=>{"use strict";s.d(t,{U:()=>a});var r=s(63606);function a(){let[e,t]=(0,r.useState)(!1),[s,a]=(0,r.useState)(!0);return{loading:s,data:e}}},72181:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(78105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\xampp\\\\htdocs\\\\codebrew2o\\\\codebrew2\\\\src\\\\app\\\\cart\\\\page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\xampp\\htdocs\\codebrew2o\\codebrew2\\src\\app\\cart\\page.js","default")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[492,426,686,971,954],()=>s(47172));module.exports=r})();