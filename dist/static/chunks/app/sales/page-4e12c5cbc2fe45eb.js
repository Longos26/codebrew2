(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[371],{67:()=>{},2061:()=>{},5717:(e,t,a)=>{Promise.resolve().then(a.bind(a,9825))},9825:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(7437),r=a(2265),l=a(5211),n=a(7346),i=a(2546),c=a(7800),d=a(152),o=a(8497);l.kL.register(l.jn,l.ZL,l.qi,l.uw,l.f$,l.od,l.Dx,l.u,l.De);let u=e=>{let{timeframe:t,setTimeframe:a}=e;return(0,s.jsxs)("div",{className:"flex gap-4 mt-4 mb-6 justify-center",children:[(0,s.jsx)("button",{className:"px-6 py-3 rounded-lg transition duration-300 ".concat("daily"===t?"bg-green-500 text-white":"bg-gray-200"),onClick:()=>a("daily"),children:"Daily"}),(0,s.jsx)("button",{className:"px-6 py-3 rounded-lg transition duration-300 ".concat("weekly"===t?"bg-green-500 text-white":"bg-gray-200"),onClick:()=>a("weekly"),children:"Weekly"}),(0,s.jsx)("button",{className:"px-6 py-3 rounded-lg transition duration-300 ".concat("monthly"===t?"bg-green-500 text-white":"bg-gray-200"),onClick:()=>a("monthly"),children:"Monthly"})]})},m=e=>{let{chartData:t,pieData:a}=e;return(0,s.jsx)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"bg-gray-100 p-6 rounded-lg shadow-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Sales Trend (Line Chart)"}),(0,s.jsx)(n.x1,{data:t})]}),(0,s.jsxs)("div",{className:"bg-gray-100 p-6 rounded-lg shadow-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Sales Distribution (Bar Chart)"}),(0,s.jsx)(n.$Q,{data:t})]}),(0,s.jsxs)("div",{className:"bg-gray-100 p-6 rounded-lg shadow-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"Revenue Streams (Pie Chart)"}),(0,s.jsx)(n.by,{data:a})]})]})})},h=e=>{let{interpretation:t}=e;return(0,s.jsxs)("div",{className:"mt-8 bg-gray-100 p-6 rounded-lg shadow-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Sales Interpretation"}),(0,s.jsx)("p",{className:"whitespace-pre-line",children:t})]})},x=()=>{let{loading:e,data:t}=(0,o.U)(),[a,l]=(0,r.useState)({}),[n,x]=(0,r.useState)(null),[f,g]=(0,r.useState)(null),[b,j]=(0,r.useState)(""),[p,N]=(0,r.useState)("daily");(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/sales?timeframe=".concat(p));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();l(t)}catch(e){console.error("Error fetching sales data:",e),l({})}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[p]),(0,r.useEffect)(()=>{Object.keys(a).length>0&&(v(),y())},[a]);let v=()=>{let e=Object.keys(a),t=Object.values(a);x({labels:e,datasets:[{label:"Sales Amount (₱)",data:t,borderColor:"rgba(75,192,192,1)",backgroundColor:"rgba(75,192,192,0.2)",tension:.1}]}),g({labels:e,datasets:[{data:t,backgroundColor:["rgba(75,192,192,0.6)","rgba(54,162,235,0.6)","rgba(255,206,86,0.6)","rgba(153,102,255,0.6)","rgba(255,159,64,0.6)"],borderWidth:1}]})},y=()=>{let e=Object.values(a).reduce((e,t)=>e+(Number(t)||0),0),t=e/Object.keys(a).length,s=Object.entries(a).map(e=>{let[t,a]=e;return{date:t,amount:Number(a)||0}});s.sort((e,t)=>t.amount-e.amount);let r="Total sales amount: ₱".concat(e.toFixed(2),"\n");r+="Average sales per day: ₱".concat(t.toFixed(2),"\n\n"),r+="Sales per date:\n",s.forEach(e=>{let{date:t,amount:a}=e;r+="- ".concat(t,": ₱").concat(a.toFixed(2),"\n")}),j(r)};return e?"Loading user info...":(null==t?void 0:t.admin)?(0,s.jsxs)("section",{className:"mt-8 max-w-4xl mx-auto p-6 bg-white shadow-lg rounded-lg",children:[(0,s.jsx)(i.Z,{isAdmin:!0}),(0,s.jsx)(u,{timeframe:p,setTimeframe:N}),(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsxs)("button",{onClick:()=>{let e=c.P6.json_to_sheet(Object.entries(a).map(e=>{let[t,a]=e;return{Date:t,Amount:a}})),t=c.P6.book_new();c.P6.book_append_sheet(t,e,"Sales Data"),c.NC(t,"sales_data.xlsx")},className:"px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all flex items-center gap-2",children:[(0,s.jsx)(d.Z,{})," Download Excel"]})}),(0,s.jsx)(m,{chartData:n,pieData:f}),(0,s.jsx)(h,{interpretation:b})]}):"Not an admin"}},8497:(e,t,a)=>{"use strict";a.d(t,{U:()=>r});var s=a(2265);function r(){let[e,t]=(0,s.useState)(!1),[a,r]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{r(!0),fetch("/api/profile").then(e=>{e.json().then(e=>{t(e),r(!1)})})},[]),{loading:a,data:e}}},2546:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var s=a(7437),r=a(7138),l=a(6463),n=a(2265);function i(e){let{isAdmin:t,isNewUser:a}=e,i=(0,l.usePathname)(),[c,d]=(0,n.useState)(!1);return(0,s.jsxs)("div",{className:"flex mx-auto gap-2 tabs justify-center flex-wrap",children:[(0,s.jsx)(r.default,{className:"/profile"===i?"active":"",href:"/profile",children:"Profile"}),!t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.default,{className:"/menu-notadmin"===i?"active":"",href:"/menu-notadmin",children:"Staff Menu Here"}),(0,s.jsx)(r.default,{className:"/staffreceipt"===i?"active":"",href:"/staffreceipt",children:"Staff Receipt"})]}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.default,{className:"/menu-list"===i?"active":"",href:"/menu-list",children:"Menu Here"}),(0,s.jsx)(r.default,{href:"/categories",className:"/categories"===i?"active":"",children:"Categories"}),(0,s.jsx)(r.default,{href:"/menu-items",className:i.includes("menu-items")?"active":"",children:"Add Items"}),(0,s.jsx)(r.default,{className:i.includes("/users")?"active":"",href:"/users",onClick:()=>{a&&(d(!0),setTimeout(()=>{d(!1)},5e3))},children:"Users"}),(0,s.jsx)(r.default,{className:i.includes("/sales")?"active":"",href:"/sales",children:"Sales"}),(0,s.jsx)(r.default,{className:i.includes("/receipt")?"active":"",href:"/receipt",children:"Receipt"}),(0,s.jsx)(r.default,{className:i.includes("/stocks")?"active":"",href:"/stocks",children:"Stocks"})]}),c&&(0,s.jsx)("div",{className:"text-red-500 mt-2",children:"Wait for admin permission on this account."})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1425,7674,7138,5060,7703,7130,6215,1744],()=>t(5717)),_N_E=e.O()}]);